"use strict";(self["webpackChunkvue_cms"]=self["webpackChunkvue_cms"]||[]).push([[728],{2739:function(e,l,a){a.d(l,{T:function(){return i}});var t=a(4870),u=a(3396);const i=e=>{const l=(0,t.iH)(window.innerHeight-e),a=()=>{l.value=window.innerHeight-e},i=a=>{e=a,l.value=window.innerHeight-a};return(0,u.bv)((()=>{window.addEventListener("resize",a)})),(0,u.Ah)((()=>{window.removeEventListener("resize",a)})),(0,u.dl)((()=>{window.addEventListener("resize",a)})),(0,u.se)((()=>{window.removeEventListener("resize",a)})),{tableHeight:l,refresh:i}}},8693:function(e,l,a){a.d(l,{P:function(){return u}});var t=a(2655);const u=({contentTxt:e,titleTxt:l,confirmButtonText:a,cancelButtonText:u,type:i},r,o)=>{t.T.confirm(e||"当前内容还未保存,确定取消吗",l||"取消保存",{confirmButtonText:a||"确认",cancelButtonText:u||"取消",type:i||"warning"}).then((()=>{r&&r()})).catch((()=>{o&&o()}))}},4781:function(e,l,a){a.d(l,{BU:function(){return i},mr:function(){return t},p6:function(){return u}});const t=e=>{let l=new Date(e/1),a=l.getFullYear(),t=("0"+(l.getMonth()+1)).slice(-2),u=("0"+l.getDate()).slice(-2),i=("0"+l.getHours()).slice(-2),r=("0"+l.getMinutes()).slice(-2),o=("0"+l.getSeconds()).slice(-2);return`${a}-${t}-${u} ${i}:${r}:${o}`},u=e=>{let l=new Date(e/1),a=l.getFullYear(),t=("0"+(l.getMonth()+1)).slice(-2),u=("0"+l.getDate()).slice(-2),i=l.getDay(),r="周一";switch(i){case 0:r="周日";break;case 1:r="周一";break;case 2:r="周二";break;case 3:r="周三";break;case 4:r="周四";break;case 5:r="周五";break;case 6:r="周六";break}return`${a}-${t}-${u} ${r}`},i=e=>{let l=new Date(e/1),a=("0"+l.getHours()).slice(-2),t=("0"+l.getMinutes()).slice(-2),u=("0"+l.getSeconds()).slice(-2);return`${a}:${t}:${u}`}},3728:function(e,l,a){a.r(l),a.d(l,{default:function(){return H}});var t=a(3396),u=a(4870),i=a(7139),r=a(4471);const o=e=>(0,r.Z)({url:"/course/courseList",params:e}),n=e=>(0,r.Z)({url:"/course/reviseCourseBase",method:"POST",data:e}),s=e=>(0,r.Z)({url:"/course/reviseCourseCover",method:"POST",data:e});var d=a(4781),c=a(2739),m=a(8693),p=a(7178);const g=e=>((0,t.dD)("data-v-19ca5f42"),e=e(),(0,t.Cn)(),e),v={class:"course-edit"},w=g((()=>(0,t._)("h4",null,"编辑课程",-1))),f={class:"cover-image"};var b={__name:"EditCourse",props:["course"],emits:["change"],setup(e,{expose:l,emit:a}){const i=e,r=(0,u.iH)(!1),o=(0,u.iH)("first"),d={kindName:"",courseName:"",originalPrice:"",sellingPrice:"",downPrice:""},c=(0,u.iH)(d),g=(0,u.iH)({kindName:[{required:!0,message:"项目名是必填项",trigger:"blur"}],courseName:[{required:!0,message:"课程名是必填项",trigger:"blur"}],originalPrice:[{required:!0,message:"原价是必填项",trigger:"blur"}],sellingPrice:[{required:!0,message:"售价是必填项",trigger:"blur"}],downPrice:[{required:!0,message:"底价是必填项",trigger:"blur"}]}),b=(0,u.iH)(null),h=(0,u.iH)({description:"",file:[]}),_=async()=>{await(0,t.Y3)();const e=c.value,l=i.course;console.log(l);for(const a in e)e[a]=l[a]},W=()=>{r.value=!0,_()},k=()=>{(0,m.P)({},(()=>{V()}))},V=()=>{r.value=!1,o.value="first",b.value.clearValidate()},U=async()=>{if("first"===o.value)b.value.validate((async e=>{if(e){const{data:e}=await n(c.value);e.code||(p.z8.success(e.txt),V(),a("change"))}else p.z8.warning("信息填写不规范")}));else{const e=h.value;if(e.description||e.file.length){let l=new FormData;l.append("courseName",i.course.courseName),e.description&&l.append("description",e.description),e.file.length&&l.append("file",e.file[0].raw);const{data:t}=await s(l);console.log(t),t.code?p.z8.error(t.txt):(p.z8.success(t.txt),V(),a("change"),e.file=[])}}};return l({open:W}),(l,a)=>{const u=(0,t.up)("el-input"),i=(0,t.up)("el-form-item"),n=(0,t.up)("el-form"),s=(0,t.up)("el-tab-pane"),d=(0,t.up)("el-button"),m=(0,t.up)("el-upload"),p=(0,t.up)("el-image"),_=(0,t.up)("el-tabs"),W=(0,t.up)("el-drawer");return(0,t.wg)(),(0,t.iD)("div",v,[(0,t.Wm)(W,{modelValue:r.value,"onUpdate:modelValue":a[8]||(a[8]=e=>r.value=e),size:"50%","before-close":k},{header:(0,t.w5)((()=>[w])),footer:(0,t.w5)((()=>[(0,t.Wm)(d,{onClick:k},{default:(0,t.w5)((()=>[(0,t.Uk)("取消")])),_:1}),(0,t.Wm)(d,{type:"primary",onClick:U},{default:(0,t.w5)((()=>[(0,t.Uk)("确认")])),_:1})])),default:(0,t.w5)((()=>[(0,t.Wm)(_,{modelValue:o.value,"onUpdate:modelValue":a[7]||(a[7]=e=>o.value=e)},{default:(0,t.w5)((()=>[(0,t.Wm)(s,{name:"first",label:"基础信息"},{default:(0,t.w5)((()=>[(0,t.Wm)(n,{model:c.value,rules:g.value,ref_key:"baseFormRef",ref:b},{default:(0,t.w5)((()=>[(0,t.Wm)(i,{label:"项目",prop:"kindName"},{default:(0,t.w5)((()=>[(0,t.Wm)(u,{modelValue:c.value.kindName,"onUpdate:modelValue":a[0]||(a[0]=e=>c.value.kindName=e),disabled:""},null,8,["modelValue"])])),_:1}),(0,t.Wm)(i,{label:"课程名称",prop:"courseName"},{default:(0,t.w5)((()=>[(0,t.Wm)(u,{modelValue:c.value.courseName,"onUpdate:modelValue":a[1]||(a[1]=e=>c.value.courseName=e),disabled:""},null,8,["modelValue"])])),_:1}),(0,t.Wm)(i,{label:"原价",prop:"originalPrice"},{default:(0,t.w5)((()=>[(0,t.Wm)(u,{modelValue:c.value.originalPrice,"onUpdate:modelValue":a[2]||(a[2]=e=>c.value.originalPrice=e)},{prefix:(0,t.w5)((()=>[(0,t.Uk)(" ￥ ")])),_:1},8,["modelValue"])])),_:1}),(0,t.Wm)(i,{label:"售价",prop:"sellingPrice"},{default:(0,t.w5)((()=>[(0,t.Wm)(u,{modelValue:c.value.sellingPrice,"onUpdate:modelValue":a[3]||(a[3]=e=>c.value.sellingPrice=e)},{prefix:(0,t.w5)((()=>[(0,t.Uk)(" ￥ ")])),_:1},8,["modelValue"])])),_:1}),(0,t.Wm)(i,{label:"底价",prop:"downPrice"},{default:(0,t.w5)((()=>[(0,t.Wm)(u,{modelValue:c.value.downPrice,"onUpdate:modelValue":a[4]||(a[4]=e=>c.value.downPrice=e)},{prefix:(0,t.w5)((()=>[(0,t.Uk)(" ￥ ")])),_:1},8,["modelValue"])])),_:1})])),_:1},8,["model","rules"])])),_:1}),(0,t.Wm)(s,{name:"second",label:"课程封面"},{default:(0,t.w5)((()=>[(0,t.Wm)(n,{model:h.value},{default:(0,t.w5)((()=>[(0,t.Wm)(i,{label:"课程描述"},{default:(0,t.w5)((()=>[(0,t.Wm)(u,{modelValue:h.value.description,"onUpdate:modelValue":a[5]||(a[5]=e=>h.value.description=e),placeholder:e.course.description},null,8,["modelValue","placeholder"])])),_:1}),(0,t.Wm)(i,{label:"更换封面"},{default:(0,t.w5)((()=>[(0,t.Wm)(m,{"file-list":h.value.file,"onUpdate:file-list":a[6]||(a[6]=e=>h.value.file=e),"auto-upload":!1,limit:1,accept:".png,.jpg"},{tip:(0,t.w5)((()=>[(0,t.Uk)(" 建议:课程封面大小建议上传1125*633,不超过5M,格式为jpg、png")])),default:(0,t.w5)((()=>[(0,t.Wm)(d,{type:"primary"},{default:(0,t.w5)((()=>[(0,t.Uk)("选择文件")])),_:1})])),_:1},8,["file-list"])])),_:1}),(0,t._)("div",f,[(0,t.Wm)(p,{style:{width:"100px",height:"100px"},src:e.course.coverImage,"preview-src-list":[e.course.coverImage],"initial-index":0,fit:"cover"},null,8,["src","preview-src-list"])])])),_:1},8,["model"])])),_:1})])),_:1},8,["modelValue"])])),_:1},8,["modelValue"])])}}},h=a(89);const _=(0,h.Z)(b,[["__scopeId","data-v-19ca5f42"]]);var W=_;const k={class:""},V=(0,t._)("h4",null,"课程管理",-1),U={class:"filter-section"};var P={__name:"index",setup(e){const l=(0,u.iH)({pageSize:10,currentPage:1,kindName:"",courseName:""}),a=(0,u.iH)([]),r=(0,u.iH)([]),n=(0,u.iH)(0),s=(0,u.iH)(!0),m=(0,u.iH)(null),p=(0,u.iH)({}),{tableHeight:g}=(0,c.T)(340),v=async()=>{s.value=!0;const{data:e}=await o(l.value);console.log(e),r.value=e.data,n.value=e.total,a.value=e.kindNameOptions,setTimeout((()=>{s.value=!1}),500)};v();const w=e=>{p.value=e,m.value.open()};return(e,o)=>{const c=(0,t.up)("el-card"),f=(0,t.up)("el-option"),b=(0,t.up)("el-select"),h=(0,t.up)("el-input"),_=(0,t.up)("el-table-column"),P=(0,t.up)("el-switch"),x=(0,t.up)("el-button"),H=(0,t.up)("el-table"),N=(0,t.up)("el-pagination"),z=(0,t.Q2)("loading");return(0,t.wg)(),(0,t.iD)("div",k,[(0,t.Wm)(c,null,{default:(0,t.w5)((()=>[V])),_:1}),(0,t.Wm)(c,{class:"table"},{default:(0,t.w5)((()=>[(0,t._)("div",U,[(0,t.Wm)(b,{modelValue:l.value.kindName,"onUpdate:modelValue":o[0]||(o[0]=e=>l.value.kindName=e),clearable:"",class:"filter",placeholder:"请选择项目",onChange:v},{default:(0,t.w5)((()=>[((0,t.wg)(!0),(0,t.iD)(t.HY,null,(0,t.Ko)(a.value,(e=>((0,t.wg)(),(0,t.j4)(f,{key:e,value:e,label:e},null,8,["value","label"])))),128))])),_:1},8,["modelValue"]),(0,t.Wm)(h,{modelValue:l.value.courseName,"onUpdate:modelValue":o[1]||(o[1]=e=>l.value.courseName=e),clearable:"",placeholder:"请输入课程名称",class:"filter",onChange:v},null,8,["modelValue"])]),(0,t.wy)(((0,t.wg)(),(0,t.j4)(H,{data:r.value,class:"table-wrapper","max-height":(0,u.SU)(g)},{default:(0,t.w5)((()=>[(0,t.Wm)(_,{width:"200",prop:"courseName",label:"课程名称",fixed:"left"}),(0,t.Wm)(_,{width:"200",prop:"sellingPrice",label:"售价"}),(0,t.Wm)(_,{width:"200",prop:"downPrice",label:"底价"}),(0,t.Wm)(_,{width:"200",prop:"kindName",label:"项目"}),(0,t.Wm)(_,{width:"200",label:"是否售卖"},{default:(0,t.w5)((({row:e})=>[(0,t.Wm)(P,{modelValue:e.isSale,"onUpdate:modelValue":l=>e.isSale=l,"active-color":"#13ce66","active-text":"上架",disabled:""},null,8,["modelValue","onUpdate:modelValue"])])),_:1}),(0,t.Wm)(_,{width:"200",prop:"updatePeople",label:"更新人"}),(0,t.Wm)(_,{width:"200",label:"更新时间"},{default:(0,t.w5)((({row:e})=>[(0,t.Uk)((0,i.zw)((0,u.SU)(d.mr)(e.updateTime)),1)])),_:1}),(0,t.Wm)(_,{width:"200",label:"操作",fixed:"right",align:"center"},{default:(0,t.w5)((({row:e})=>[(0,t.Wm)(x,{size:"small",onClick:l=>w(e)},{default:(0,t.w5)((()=>[(0,t.Uk)("编辑课程")])),_:2},1032,["onClick"])])),_:1})])),_:1},8,["data","max-height"])),[[z,s.value]]),(0,t.Wm)(N,{"current-page":l.value.currentPage,"onUpdate:current-page":o[2]||(o[2]=e=>l.value.currentPage=e),"page-size":l.value.pageSize,"onUpdate:page-size":o[3]||(o[3]=e=>l.value.pageSize=e),"page-sizes":[10,20,50,100],layout:"total, sizes, prev, pager, next, jumper",total:n.value,onSizeChange:v,onCurrentChange:v,class:"pagination"},null,8,["current-page","page-size","total"])])),_:1}),(0,t.Wm)(W,{ref_key:"editCourseRef",ref:m,course:p.value,onChange:v},null,8,["course"])])}}};const x=P;var H=x}}]);
//# sourceMappingURL=728.50b8fe04.js.map